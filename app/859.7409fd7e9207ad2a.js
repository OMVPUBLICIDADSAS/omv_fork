"use strict";(self.webpackChunkquote_cli_01=self.webpackChunkquote_cli_01||[]).push([[859],{6859:(M,c,o)=>{o.r(c),o.d(c,{UsersModule:()=>k});var u=o(6895),d=o(2510),t=o(4650),g=o(2327),v=o(9340),m=o(7009),f=o(8139),C=o(4726),p=o(7392),l=o(1561);const b=["editControlTrigger"];function x(r,L){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",8)(2,"div",9),t._uU(3),t.qZA(),t.TgZ(4,"div",10),t._uU(5),t.qZA(),t.TgZ(6,"span",11)(7,"mat-icon",12),t.NdJ("click",function(){const i=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.editUser(i))}),t._uU(8,"edit"),t.qZA(),t.TgZ(9,"mat-icon",12),t.NdJ("click",function(){const i=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.onDelete(i))}),t._uU(10,"delete"),t.qZA()()()()}if(2&r){const e=L.$implicit;t.xp6(3),t.hij(" ",e.name," "),t.xp6(2),t.hij(" ",e.email," ")}}const y=[{path:"",component:(()=>{class r{constructor(e,s,n,i){this.dg=e,this.user=s,this.snkBar=n,this.sharedvar=i,this.userData={controls:[{name:"email",label:"Correo electr\xf3nico:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"password",label:"Contrase\xf1a:",type:"password",sideBtn:"visibility",validators:{required:!0}},{name:"name",label:"Nombre:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"phone",label:"Tel\xe9fono:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"city",label:"Ciudad:",type:"text",style:{width:"150px"},validators:{required:!0}},{name:"rol",label:"Permiso para editar:",type:"multiselect",validators:{required:!0},selectOptions:[{key:"Q",value:"Cotizaciones"},{key:"P",value:"Productos"},{key:"C",value:"Configuraci\xf3n"},{key:"U",value:"Usuarios"}]}]},this.usersList=[]}ngOnInit(){this.getList()}getList(){this.user.getUsersList().subscribe(e=>{this.usersList=e,this.orderList()})}orderList(){this.usersList.sort((e,s)=>e.name.localeCompare(s.name))}getClicked(e){switch(e.index){case 2:this.createUser();break;case 4:let s=document.getElementById("spanTrigger");s&&(s.style.display="",s.style.position="absolute",s.style.left=e.pageX+5+"px",s.style.top=e.pageY+5+"px",this.editControlTrigger.openMenu())}}createUser(){const e=this.user.newUser();this.dg.aDefault({title:"Crear Usuario",value:e,schema:this.userData,dgheigth:615,dgwidth:300}).subscribe(n=>{if(n&&e){this.sharedvar.updatePropResult(e,n);const i=this.user.createUser(e).subscribe(a=>{i&&i.unsubscribe(),a&&(this.usersList.push(a),this.orderList())})}})}editUser(e){const s={...this.userData};s.controls=s.controls?.slice(2),this.dg.aDefault({title:"Editar Usuario",value:e,schema:s,dgheigth:460,dgwidth:300}).subscribe(i=>{if(i){this.sharedvar.updatePropResult(e,i);const a=this.user.updateUser(e).subscribe(h=>{a&&a.unsubscribe()})}})}onDelete(e){return this.snkBar.open(`\xbfEliminar usuario: ${e.name}?`,"Si",{duration:3e3}).onAction().subscribe(s=>{e._id&&this.user.deleteUser(e._id).subscribe(i=>{const a=this.usersList.findIndex(h=>h._id===e._id);a>=0&&this.usersList.splice(a,1)})})}static#t=this.\u0275fac=function(s){return new(s||r)(t.Y36(g.x),t.Y36(v.z),t.Y36(m.ux),t.Y36(f.m))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-users"]],viewQuery:function(s,n){if(1&s&&t.Gf(b,5),2&s){let i;t.iGM(i=t.CRH())&&(n.editControlTrigger=i.first)}},decls:10,vars:3,consts:[[1,"flex","flex-col","h-screen","bg-slate-100"],[3,"buttons","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"overflow-auto","bg-white"],[4,"ngFor","ngForOf"],["controlEdit","matMenu"],["mat-menu-item",""],[1,"h-10","px-2","flex","items-center","bg-gray-50","mt-1"],[1,"w-52","font-medium"],[1,"ml-3","flex-1","text-sky-700"],[1,"text-sky-700"],[3,"click"]],template:function(s,n){if(1&s&&(t.TgZ(0,"div",0)(1,"app-nav-bar",1),t.NdJ("onClicked",function(a){return n.getClicked(a)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4),t.YNc(5,x,11,2,"div",5),t.qZA(),t.TgZ(6,"mat-menu",null,6)(8,"button",7),t._uU(9," Crear Usuario Maestro "),t.qZA()()()),2&s){const i=t.MAs(7);t.xp6(1),t.Q6J("buttons","101000"),t.xp6(1),t.Q6J("matMenuTriggerFor",i),t.xp6(3),t.Q6J("ngForOf",n.usersList)}},dependencies:[u.sg,C.w,p.Hw,l.VK,l.OP,l.p6]})}return r})()}];let U=(()=>{class r{static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275mod=t.oAB({type:r});static#s=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(y),d.Bz]})}return r})();var T=o(2469),Z=o(4859);let k=(()=>{class r{static#t=this.\u0275fac=function(s){return new(s||r)};static#e=this.\u0275mod=t.oAB({type:r});static#s=this.\u0275inj=t.cJS({imports:[u.ez,U,T.R,p.Ps,Z.ot,m.ZX,l.Tx]})}return r})()}}]);